<!-- ag-update.component.html -->
<div class="form-container">
  <label>AGCINO:</label>
  <input type="text" [(ngModel)]="agcino" [ngModelOptions]="{ standalone: true }" />
  <button type="button" (click)="onSearch()">Search</button>
  
  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <!-- Advocate Information -->
    <div class="section">
      <div class="section-header">
        <h3>Petitioner Advocate Information</h3>
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label>Advocate Name *</label>
          <input type="text" formControlName="pet_adv" required />
        </div>
        <div class="form-group">
          <label>AUIN Number *</label>
          <input type="text" formControlName="pet_adv_cd" required />
        </div>
        <div class="form-group">
          <label>Mobile Number</label>
          <input type="text" formControlName="pet_adv_mobile" />
        </div>
        <div class="form-group">
          <label>Address</label>
          <input type="text" formControlName="pet_adv_add" />
        </div>
        <div class="form-group">
          <label>Case Subject</label>
          <input type="text" formControlName="subject" />
        </div>
      </div>
    </div>

    <!-- Basic Case Information -->
    <div class="section">
      <div class="section-header">
        <h3>Basic Information of Case</h3>
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label>Case Type *</label>
          <select formControlName="ci_cri" (change)="selectCaseType($event)" required>
            <option value="">-- Select Case Type --</option>
            <option value="1">Civil</option>
            <option value="2">Criminal</option>
          </select>
        </div>
        <div class="form-group">
          <label>Nature of Case *</label>
          <select formControlName="regcase_type" required>
            <option value="">-- Select Nature of Case --</option>
            <option *ngFor="let cn of caseNatures" [value]="cn.type_flag">{{ cn.case_type }}</option>
          </select>
        </div>
        <div class="form-group">
          <label>Arising out of</label>
          <input type="text" formControlName="ariser_from" />
        </div>
        <div class="form-group">
          <label>Arise of Case Number</label>
          <input type="text" formControlName="arisereg_no" />
        </div>
        <div class="form-group">
          <label>Year</label>
          <select formControlName="arisereg_year">
            <option value="">-- Select Year --</option>
            <option *ngFor="let y of years" [value]="y">{{ y }}</option>
          </select>
        </div>
        <div class="form-group">
          <label>Mark law officer/A.P.P. *</label>
          <select formControlName="law_officer_cd" required>
            <option value="">-- Select Law Officer --</option>
            <option *ngFor="let law of lawOfficers" [value]="law.value">{{ law.text }}</option>
          </select>
        </div>
        <div class="form-group">
          <label>Due Date For Court *</label>
          <input type="date" formControlName="date_of_due" />
        </div>
        <div class="form-group">
          <label>Entry Date *</label>
          <input type="date" formControlName="date_of_receiving" />
        </div>
      </div>
    </div>

    <!-- Party Details Section -->
    <div class="section">
      <div class="section-header">
        <h3>Party Details</h3>
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label>Party Name *</label>
          <input type="text" [(ngModel)]="partyModel.name" required [ngModelOptions]="{standalone: true}" />
        </div>
        <div class="form-group">
          <label>Father/Husband Name</label>
          <input type="text" [(ngModel)]="partyModel.father_name" [ngModelOptions]="{standalone: true}" />
        </div>
        <div class="form-group">
          <label>Party Address</label>
          <input type="text" [(ngModel)]="partyModel.address" [ngModelOptions]="{standalone: true}" />
        </div>
        <div class="form-group">
          <label>Petitioner's District *</label>
          <select [(ngModel)]="partyModel.district" required [ngModelOptions]="{standalone: true}">
            <option value="">-- Select District --</option>
            <option *ngFor="let dist of districts" [value]="dist.value">{{ dist.text }}</option>
          </select>
        </div>
        <div class="btn-wrapper">
          <button type="button" (click)="addParty()" class="btn-add">
            {{ isEditingParty ? 'Update' : 'Add' }}
          </button>
          <button *ngIf="isEditingParty" type="button" (click)="cancelEditParty()" class="btn-cancel">
            Cancel
          </button>
        </div>
      </div>

      <!-- Party Table -->
      <div *ngIf="party.length > 0" class="table-container">
        <table class="professional-table">
          <thead>
            <tr>
              <th>Party No</th>
              <th>Name</th>
              <th>Father/Husband Name</th>
              <th>Address</th>
              <th>District</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let p of party; let i = index">
              <td>{{ p.party_no }}</td>
              <td>{{ p.name }}</td>
              <td>{{ p.father_name }}</td>
              <td>{{ p.pet_address }}</td>
              <td>{{ getDistrictName(p.pet_dist_code) }}</td>
              <td class="action-cell">
                <button type="button" class="btn-edit" (click)="editParty(i)">Edit</button>
                <button type="button" class="btn-delete" (click)="deleteParty(i)">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Respondent Details Section -->
    <div class="section">
      <div class="section-header">
        <h3>Respondent Details</h3>
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label>Respondent Name *</label>
          <input type="text" [(ngModel)]="respondentModel.name" required [ngModelOptions]="{standalone: true}" />
        </div>
        <div class="form-group">
          <label>Father/Husband Name</label>
          <input type="text" [(ngModel)]="respondentModel.father_name" [ngModelOptions]="{standalone: true}" />
        </div>
        <div class="form-group">
          <label>Respondent Address</label>
          <input type="text" [(ngModel)]="respondentModel.address" [ngModelOptions]="{standalone: true}" />
        </div>
        <div class="form-group">
          <label>Respondent's District *</label>
          <select [(ngModel)]="respondentModel.district" required [ngModelOptions]="{standalone: true}">
            <option value="">-- Select District --</option>
            <option *ngFor="let dist of districts" [value]="dist.value">{{ dist.text }}</option>
          </select>
        </div>
        <div class="form-group">
          <label>Concern Department *</label>
          <select [(ngModel)]="respondentModel.department" required [ngModelOptions]="{standalone: true}">
            <option value="">-- Select Department --</option>
            <option *ngFor="let dept of concernDepartments" [value]="dept.user_code">{{ dept.name }}</option>
          </select>
        </div>
        <div class="btn-wrapper">
          <button type="button" (click)="addRespondent()" class="btn-add">
            {{ isEditingRespondent ? 'Update' : 'Add' }}
          </button>
          <button *ngIf="isEditingRespondent" type="button" (click)="cancelEditRespondent()" class="btn-cancel">
            Cancel
          </button>
        </div>
      </div>

      <!-- Respondent Table -->
      <div *ngIf="respondents.length > 0" class="table-container">
        <table class="professional-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Name</th>
              <th>Father Name</th>
              <th>Address</th>
              <th>District</th>
              <th>Department</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let r of respondents; let i = index">
              <td>{{ r.party_no }}</td>
              <td>{{ r.name }}</td>
              <td>{{ r.father_name }}</td>
              <td>{{ r.pet_address }}</td>
              <td>{{ getDistrictName(r.pet_dist_code) }}</td>
              <td>{{ getDepartmentName(r.concerned_officer_id) }}</td>
              <td>
                <button type="button" class="btn-edit" (click)="editRespondent(i)">Edit</button>
                <button type="button" class="btn-delete" (click)="deleteRespondent(i)">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="btn-wrapper">
      <button type="submit">Update</button>
    </div>
  </form>
</div>
